import 'dotenv/config';
import { getDb } from '../server/db';
import { ragDocuments } from '../drizzle/schema';
import { eq } from 'drizzle-orm';

const additionalContent = `
（通るオファーのロジック）

ここまでまとめたとおり全ての市場には破綻があります。ただ、残念ながら読者も販売者も破綻に気づいていません。

よって、以下の構図で語りかけることでオファーを通し、読者と共に成長する階段を描けます。

以下、英語市場の切り口から掘り下げますが、全市場同じ構図・パターンで行けます。

〜・〜・〜・〜・〜・〜・〜・〜・〜
＃１：市場の破綻の構図

A）表面的解決策：単語、フレーズ、文法、暗記

B）相手の動機：サラリーマンで昇進するため、就職のため、老後の趣味

C）販売者の宣伝文句：「単語、フレーズを覚えてTOEIC満点になろう。ペラペラになろう」

D）市場の顧客の問題：本質的には外国人と仲良くなりたいわけじゃないということ。目の前の外国人「と」仲良くなりたいわけでもない。結果、外国人を目の前にした時話すことが思い付かず、空気感が苦しくなり、頭が真っ白になる。

E）市場の問題点：「頭が真っ白になる」ことは、本質的には対人関係の問題なのに販売者がその指摘をせず、むしろ「今度こそ真っ白にならない記憶術」として、新たな商品を買う理由にしている。

F）販売者の問題点：販売者が保身に走っている。稼げる時に稼いでおこうとしてるだけ。大半の販売者がコピービジネスで、英語の講座は売れば儲かるでスタートしていること。

G）市場の歪み・問題点：「頭が真っ白になる」人に対する本質的改善策が提供されていない。

H）本質的改善策：興味がない人でも仲良くなれる力。つまり洞察力

→このHを身につけることの必要性を、語り、Hを身につけるためのオファーとして作成することこそ必勝型。

〜・〜・〜・〜・〜・〜・〜・〜・〜
＃２：読者理解のロジック

＃１により、読者「単語、フレーズを覚えてTOEIC満点になろう。ペラペラになろう」ばかり聞かされています。結果、こんな内心になります。

✅ TOEICで満点取ったらペラペラになれる。
✅ TOEICで満点取ったら幸せになれる。
✅ TOEICや英検で上位を取ったら、会社でも重宝される。
・・・そう思っていたのに、外国人を目の前にしたら頭が真っ白になるし、全然自分はダメだ。
みたいな感じ。

この中で、英語を切り口にネット集客をするなら、必須で「単語、フレーズを覚えてTOEIC満点になろう。ペラペラになろう」ということに関することを語るべきです。これ以外のことを語ってもダメです。読まれないし開かれない。これがカラーバス効果です。


ただ同時に「単語、フレーズを覚えてTOEIC満点になろう。ペラペラになろう」という人に胡散臭さも感じています。

なぜなら同じ主張を、どの販売者もやっていて、みんなで特典競争・価格競争をしているからです。

『（１）勧誘臭がある＋（２）自分が似たものを買って、前ダメだった。もしくは、そんな話を聞いた』この２つが揃った瞬間、人は警戒します。

これが、クリックはするけど離脱する構図です。

〜・〜・〜・〜・〜・〜・〜・〜・〜
＃３：通るオファーのロジック

じゃあ、どうするのか。
それは「適切な批判＋結果が出ていない理由」をセットにして体系化して提示することです。つまり、正しい解説。

例えば「英語がペラペラになれない人向けのネットビジネス成功法」ではどう考えるか。

それは、英語はどうやったらペラペラになるか。その視点で記事は成立させること。なぜなら、相手は「英語の商材を買ったのに、ペラペラになれない自分」に落ち込んでいるから。

よって、章立てはこうなります。
１章：なぜ英語はペラペラになれないのか
２章：なぜ英語市場で解決できないのか
３章：英語市場の構成
４章：君がうまくいくための秘訣
５章：秘訣を習得するための手段
・ネットビジネス以外にもいくつも紹介
６章：オファー

先ほどのA）〜H）でいくと、


＃１の章立てでいくと、

１章：なぜ英語はペラペラになれないのか
『D）市場の顧客の問題・E）市場の問題点・F）販売者の問題点』の中で、読者が受け入れていいなと思えるメンタル負荷の指摘

２章：なぜ英語市場で解決できないのか
D）・E）・F）を元にした、販売商品の問題点の指摘。表面上の解決では限界があることの指摘。

３章：英語市場の構成
F）の具体的解説

４章：君がうまくいくための秘訣
『G）市場の歪み・問題点』の視点から『H）本質的改善策』の匂わせ

５章：秘訣を習得するための手段
ネットビジネス以外で『H）本質的改善策』を磨くとしたら、どれだけ大変か語る。

６章：オファー
『H）本質的改善策』を磨くとしたら、ネットビジネスが最優であることを示し、オファーへ誘導

とすること。

〜・〜・〜・〜・〜・〜・〜・〜・〜
＃４：転用例、他市場の構成（重要パターン）

上記の流れをまとめると、

A）表面的解決策が売られ、
　 ↓
C）その時の宣伝文句があり、
　 ↓
G）でも叶わない市場の問題がある

という構図です。この流れが全市場共通。


例えば、

市場１：ネットナンパ

A）表面的解決策：いい写真、いい自己紹介、ファッション、髪型

C）宣伝文句：「モテるファッション、髪型、自己紹介の添削で非モテ卒業」

G）市場の問題：需要と供給の問題で、供給過多になり結局没個性。仮にマッチングしても、モテるコミュ力が身についたわけじゃないからモテない。また自分も理解してるから、実戦が遠い。

市場２：ネットビジネス

A）表面的解決策：売れてる商品をパクリ、売れてるブランディングをパクる

C）宣伝文句：TTP。徹底してぱくれ。成功者の真似で稼げ。

G）市場の問題：需要と供給の問題で、供給過多になり何もできない。売れない。独自の道を進もうにも、パクることしかできないし考えられない。

市場３：釣り

A）表面的解決策：釣れてる釣り場で、釣れてるルアー

C）宣伝文句：このルアーは餌だ。

G）市場の問題：需要と供給の問題で、有名釣り場はいつも混雑。自分で釣り場を探そうにも、海を理解してるわけでもないから、釣れない。

市場４：カフェ

A）表面的解決策：美味しい豆、焙煎技術、評判の内装・立地

C）宣伝文句：好きなことを仕事に。

G）市場の問題：経営の本質を知らず、経営母体をつくらず、一念発起した場合、大体苦労する。

このような感じです。

この視点でまとめると、各市場で結果が出せずに困っている人は「自分で考える気がない。依存心がある人」だと言えます。

ということは、H）本質的改善策は、必ず論理立てて考える力。つまり洞察力だとまとめられます。

この点で、洞察をし・章立てをまとめたら基本負けないです。
`;

async function main() {
  const db = await getDb();
  if (!db) return;

  // Fetch current content
  const currentDoc = await db.select().from(ragDocuments).where(eq(ragDocuments.id, 1896));
  if (currentDoc.length === 0) {
    console.log('Doc 1896 not found');
    return;
  }

  const currentContent = currentDoc[0].content;
  const newContent = currentContent + "\n" + additionalContent;

  // Update
  await db.update(ragDocuments)
    .set({ content: newContent })
    .where(eq(ragDocuments.id, 1896));

  console.log(`Updated RAG 1896. New length: ${newContent.length} chars.`);
}

main();
